<section id="contacts">
  <form>
    <div class="d-flex justify-content-center">
        <h2> Contactos </h2>
    </div>
    <section class="d-flex flex-row justify-content-between">
        <form class="d-flex">
            <input class="form-control me-2" type="search" name ="searchTerm" placeholder="Buscar" aria-label="Search" [(ngModel)]="service.searchTerm">  
        </form>
        <span class="ml-3 btn btn-outline-primary" *ngIf="service.loading$ | async">Loading...</span>
        <form class="d-flex">
            <button type="button" class="btn btn-outline-primary">
              <i class="bi bi-cloud-arrow-up-fill"></i> Importar
            </button>
            <div ngbDropdown class="d-inline-block">
              <button class="btn btn-outline-primary" id="dropdownBasic1" ngbDropdownToggle><i class="bi bi-cloud-arrow-down-fill"></i> Exportar</button>
              <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
                <button ngbDropdownItem>Seleccion</button>
                <button ngbDropdownItem>Todos</button>
              </div>
            </div>
            
            <button type="button" class="btn btn-primary" (click)="openModal()">
              <i class="bi bi-cloud-plus-fill"></i> Agregar contacto
            </button>
        </form>
    </section>

    <app-popup [title]="'Agregar contacto'" [display]="displayNewContact" (popupClose)="onCloseHandled('newContact')">
      <form> 
        <div class="input-group">
          
        </div> 
        <div class="input-group">
          <div class="form-floating mb-3">
            <input type="email" class="form-control" id="floatingInput" placeholder="Pilar">
            <label for="floatingInput">Nombre</label>
          </div>
          <div class="form-floating mb-3">
            <input type="email" class="form-control" id="floatingInput" placeholder="Garcia">
            <label for="floatingInput">Apellido</label>
          </div>
          <div class="form-floating mb-3">
            <input type="email" class="form-control" id="floatingInput" placeholder="Developer">
            <label for="floatingInput">Cargo</label>
          </div>
          <div class="form-floating mb-3">
            <input type="email" class="form-control" id="floatingInput" placeholder="pilargarcia@example.com">
            <label for="floatingInput">Email</label>
          </div>
          <div class="form-floating mb-3">
            <input type="email" class="form-control" id="floatingInput" placeholder="acamica">
            <label for="floatingInput">Compañía</label>
          </div>
        </div>
        <div class="input-group">
          <div class="mb-3">
            <label for="region" class="form-label">Región</label>
            <input type="text" class="form-control" id="region">
          </div>
          <div class="mb-3">
            <label for="pais" class="form-label">País</label>
            <input type="text" class="form-control" id="pais">
          </div>
          <div class="mb-3">
            <label for="ciudad" class="form-label">Ciudad</label>
            <input type="text" class="form-control" id="ciudad">
          </div>
          <div class="mb-3">
            <label for="direccion" class="form-label">Dirección</label>
            <input type="text" class="form-control" id="direccion">
          </div>
          <div class="mb-3">
            <label for="interes" class="form-label">Interés</label>
            <div class="form-control progress-bar-container"><ngb-progressbar class="progress-bar" type="success" textType="white" [value]="25" [showValue]="true"></ngb-progressbar></div>
          </div>
        </div>
      </form>
    </app-popup>

    <app-popup [title]="'Acciones'" [icon]="'bi bi-command'" [showConfirm]="false" [display]="displayMoreActions" (popupClose)="onCloseHandled('moreActions')">
      <div class="d-flex justify-content-between">
        <button type="button" class="btn btn-outline-primary">
          <i class="bi bi-trash"></i> Eliminar
        </button>
        <button type="button" class="btn btn-outline-primary">
          <i class="bi bi-pencil"></i> Editar
        </button>
      </div>
    </app-popup>

    <table class="table table-striped">
      <thead>
      <tr>
        <th scope="col">
          <input class="form-check-input" type="checkbox" [(ngModel)]="checkAllContactsModel" 
          (change)="checkAllContacts()" [ngModelOptions]="{standalone: true}" id="checkAllContacts">
        </th>
        <th scope="col" sortable="name" (sort)="onSort($event)">
          Contacto <i class="bi bi-arrow-down-up" *ngIf="sortedElement != 'name'" ></i>
          <i class="bi bi-arrow-down" *ngIf="sortedElement == 'name' && sortedDirection == 'desc' "></i>
          <i class="bi bi-arrow-up" *ngIf="sortedElement == 'name' && sortedDirection == 'asc' "></i>
        </th>
        <th scope="col" sortable="area" (sort)="onSort($event)">País/Región 
          <i class="bi bi-arrow-down-up" *ngIf="sortedElement != 'area'" ></i>
          <i class="bi bi-arrow-down" *ngIf="sortedElement == 'area' && sortedDirection == 'desc' "></i>
          <i class="bi bi-arrow-up" *ngIf="sortedElement == 'area' && sortedDirection == 'asc' "></i>
        </th>
        <th scope="col" sortable="population" (sort)="onSort($event)">Compañía 
          <i class="bi bi-arrow-down-up" *ngIf="sortedElement != 'population'" ></i>
          <i class="bi bi-arrow-down" *ngIf="sortedElement == 'population' && sortedDirection == 'desc' "></i>
          <i class="bi bi-arrow-up" *ngIf="sortedElement == 'population' && sortedDirection == 'asc' "></i>
        </th>
        <th scope="col" class="action-item"> 
           acciones
        </th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let country of countries$ | async; index as i">
        <th scope="row"><input class="form-check-input" type="checkbox" [(ngModel)]="country.checked" [ngModelOptions]="{standalone: true}" id="{{'checkContact'+i}}"></th>
        <td>
          <img [src]="'https://upload.wikimedia.org/wikipedia/commons/' + country.flag" class="mr-2" style="width: 20px">
          <ngb-highlight [result]="country.name" [term]="service.searchTerm"></ngb-highlight>
        </td>
        <td><ngb-highlight [result]="country.area | number" [term]="service.searchTerm"></ngb-highlight></td>
        <td><ngb-highlight [result]="country.population | number" [term]="service.searchTerm"></ngb-highlight></td>
        <td class="action-item" (click)="showMoreActions()"><ngb-highlight [result]="'...'"></ngb-highlight></td>
      </tr>
      </tbody>
    </table>
  
    <div class="d-flex justify-content-between p-2">
      <ngb-pagination
        [collectionSize]="(total$ | async)!" [(page)]="service.page" [pageSize]="service.pageSize">
      </ngb-pagination>
  
      <select class="custom-select" style="width: auto" name="pageSize" [(ngModel)]="service.pageSize">
        <option [ngValue]="2">2 Contactos por página</option>
        <option [ngValue]="4">4 Contactos por página</option>
        <option [ngValue]="6">6 Contactos por página</option>
      </select>
    </div>
  
  </form>
</section>

